package com.suse.matcher.rules;

import com.suse.matcher.model.Subscription;
import com.suse.matcher.model.System;

rule "partNumber 874-005030"
    agenda-group "InputAugmenting"
    when
        $subscription : Subscription(partNumber == "874-005030")
    then
        modify($subscription) {
            virtualizationPolicy = Subscription.UNLIMITED_VIRTUALIZATION,
            supportLevel = Subscription.STANDARD,
            cpus = 32,
            stackable = false,
            productIds.add(1);
        };
end

rule "partNumber 874-005031"
    agenda-group "InputAugmenting"
    when
        $subscription : Subscription(partNumber == "874-005031")
    then
        modify($subscription) {
            virtualizationPolicy = Subscription.UNLIMITED_VIRTUALIZATION,
            supportLevel = Subscription.STANDARD,
            cpus = 8,
            stackable = false,
            productIds.add(1);
        };
end

rule "partNumber 874-005032"
    agenda-group "InputAugmenting"
    when
        $subscription : Subscription(partNumber == "874-005032")
    then
        modify($subscription) {
            virtualizationPolicy = Subscription.UNLIMITED_VIRTUALIZATION,
            supportLevel = Subscription.STANDARD,
            cpus = 8,
            stackable = false,
            productIds.add(1),
            productIds.add(2);
        };
end

rule "partNumber 874-005033"
    agenda-group "InputAugmenting"
    when
        $subscription : Subscription(partNumber == "874-005033")
    then
        modify($subscription) {
            virtualizationPolicy = Subscription.UNLIMITED_VIRTUALIZATION,
            supportLevel = Subscription.STANDARD,
            cpus = 4,
            stackable = false,
            productIds.add(1);
        };
end

rule "partNumber 874-005034"
    agenda-group "InputAugmenting"
    when
        $subscription : Subscription(partNumber == "874-005034")
    then
        modify($subscription) {
            virtualizationPolicy = Subscription.UNLIMITED_VIRTUALIZATION,
            supportLevel = Subscription.STANDARD,
            cpus = 2,
            stackable = false,
            productIds.add(1);
        };
end

rule "ensure virtual systems are indeed virtual"
agenda-group "InputAugmenting"
when
    $guest : System(physical)
    $host : System(virtualSystemIds contains $guest.id )
then
    modify($guest) {
        physical = false;
    }
end
